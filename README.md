# project-practice-flaring-gas
ML-detection-flaring-gas

Описание проекта: Концепция и прототип продукта, который использует предобученные модели машинного обучения для обработки визуальных данных (изображений) горящих факелов на углеводородных месторождениях с последующей оценкой объема сжигания газа и выбросов СО2 в атмосферу Земли.

__Бизнес-постановка задачи:__ Создание автоматизированной системы мониторинга для нефтегазовых компаний и экологических надзорных органов, которая по спутниковым или наземным снимкам месторождений в режиме, близком к реальному времени, обнаруживает факельные установки, оценивает интенсивность горения и переводит её в ключевые бизнес- и экологические метрики: объём бесполезно сожжённого попутного нефтяного газа (ПНГ) и объём выбросов CO₂. _Это позволит компаниям сократить потери ресурсов, оптимизировать производство, выполнять нормативы по утилизации ПНГ и точно отчитываться о выбросах, а регуляторам — объективно контролировать экологическую обстановку._
__Постановка задачи в терминах Data Science и план решения:__
__Задача DS:__ Обнаружить на изображении-обекта инфраструктуры месторождения горящий факел - объект (Object Detection) оценки и реализовать последующую регрессию излеченных из изображения факела признаков (площадь факела, яркость, дымность и пр.) для расчета объемов сжигания углеводородного газа и массу выбросов СО2 в атмосферу Земли.

 - Первичная задача: Обнаружение объектов — модель должна на изображении найти и локализовать (обвести bounding box'ом) все факельные установки.

 - Вторичная задача: Регрессия — на основе характеристик обнаруженного факела (например, площадь и яркость пламени, его геометрические параметры) нужно спрогнозировать числовую величину "в момент": объем сжигаемого газа, а затем и массу выбросов CO₂.

__Ключевые термины:__

 - __Bounding Box:__ Прямоугольная область, ограничивающая объект (факел) на изображении.

 - __Предобученная модель (Pretrained Model):__ Модель (например, YOLO, которая часто используется в Roboflow), уже обученная на большом общем наборе данных (например, COCO). Это позволяет "дообучить" (fine-tune) её на наших специфичных данных, экономя время и вычислительные ресурсы.

 - __Аннотация данных:__ Процесс разметки данных — на каждом изображении из набора данных вручную обводятся факелы и присваивается класс ("flare").

 - __Перенос обучения (Transfer Learning):__ Использование предобученной модели в качестве стартовой точки для нашей конкретной задачи.

 - __Метрики оценки для детекции:__ Precision (точность), Recall (полнота), mAP (mean Average Precision) — покажут, насколько хорошо модель находит факелы и не путает их с другими объектами.

 - __Метрики для регрессии:__ MAE (Mean Absolute Error), RMSE (Root Mean Square Error) — покажут среднюю ошибку в оценке объема газа (например, в тыс. м³/сутки)

 

[Корневая директория] E:\Python\MIFI\project-practice
 - [файл ] main.ipynb
 - [файл (только код)]  main.py
[Виртуальное окружение проекта] E:\Python\MIFI\project-practice\venv
[Дириктория с изображениями ] E:\Python\MIFI\project-practice\flaring-gas
[Дириктория с сырыми не обработанными изображениями, фотографиями факелов, которые пользователь отправляет на детекцию] E:\Python\MIFI\project-practice\flaring-gas\row
[Дириктория с сырыми не обработанными изображениями, фотографиями факелов, которые отбраны для обучения модели] E:\Python\MIFI\project-practice\flaring-gas\train
[Дириктория с сырыми не обработанными изображениями, фотографиями факелов, которые прошли обработку, на которые наносится разметка детекции факела и его параметры] E:\Python\MIFI\project-practice\flaring-gas\detected
[Дириктория с сырыми не обработанными изображениями, фотографиями факелов, которые отбраны для калибровки и подтверждения валиджности модели] E:\Python\MIFI\project-practice\flaring-gas\valid

Структура проекта:

[Корневая директория] E:\Python\MIFI\project-practice\
├── 📁 data/                           # ВСЕ данные проекта (рекомендуется добавить в .gitignore)
│   ├── 📁 raw/                        # Исходные необработанные данные (изначально пустая)
│   │   └── .gitkeep                  # Пустой файл для сохранения структуры в Git
│   ├── 📁 external/                   # Внешние данные (скачанные с интернета)
│   ├── 📁 interim/                    # Промежуточные обработанные данные
│   └── 📁 processed/                  # Финальные данные для модели (объединение train/valid/test)
│       ├── 📁 images/                 # Изображения после препроцессинга
│       │   ├── 📁 train/
│       │   ├── 📁 valid/
│       │   └── 📁 test/
│       └── 📁 labels/                 # Текстовые файлы с разметкой в формате YOLO
│           ├── 📁 train/
│           ├── 📁 valid/
│           └── 📁 test/
│
├── 📁 models/                         # Модели и веса
│   ├── pretrained/                   # Предобученные модели (YOLO)
│   ├── trained/                      # Наши дообученные модели
│   │   ├── detection_model/          # Модель детекции факелов
│   │   │   ├── weights/              # best.pt, last.pt
│   │   │   └── config.yaml           # Конфиг модели для Roboflow/YOLO
│   │   └── regression_model/         # Модель регрессии для оценки объема
│   │       ├── model.pkl
│   │       └── scaler.pkl            # Scaler для нормализации признаков
│   └── calibration_data/             # Данные для калибровки (CSV с метриками факелов)
│       └── flare_measurements.csv
│
├── 📁 src/                            # Исходный код проекта
│   ├── 📁 data_preprocessing/        # Скрипты для работы с данными
│   │   ├── download_dataset.py
│   │   ├── prepare_dataset.py        # Подготовка данных в YOLO-формат
│   │   └── augmentations.py          # Скрипты аугментации
│   ├── 📁 detection/                 # Детекция объектов
│   │   ├── train_detector.py
│   │   ├── detect.py                 # Инференс на изображениях/видео
│   │   └── evaluate_detector.py      # Оценка модели детекции
│   ├── 📁 regression/                # Оценка объема газа и выбросов
│   │   ├── extract_features.py       # Извлечение признаков из bounding boxes
│   │   ├── train_regressor.py
│   │   └── calculate_emissions.py    # Расчет выбросов CO2
│   ├── 📁 visualization/             # Визуализация результатов
│   │   ├── plot_results.py
│   │   └── create_report.py          # Генерация отчетов
│   └── 📁 utils/                     # Вспомогательные утилиты
│       ├── config.py                 # Загрузка конфигураций
│       ├── helpers.py                # Общие функции
│       └── roboflow_integration.py   # Работа с Roboflow API
│
├── 📁 notebooks/                      # Jupyter ноутбуки для исследований
│   ├── 01_data_exploration.ipynb     # Анализ данных
│   ├── 02_model_training.ipynb       # Обучение моделей
│   ├── 03_results_analysis.ipynb     # Анализ результатов
│   └── main.ipynb                    # Основной ноутбук
│
├── 📁 configs/                        # Конфигурационные файлы
│   ├── dataset.yaml                  # Настройки датасета
│   ├── model_detection.yaml          # Параметры модели детекции
│   ├── model_regression.yaml         # Параметры регрессии
│   └── paths.yaml                    # Пути к данным и моделям
│
├── 📁 experiments/                    # Результаты экспериментов
│   ├── exp_001_detection/            # Эксперимент 1
│   │   ├── metrics/                  # Графики и метрики
│   │   ├── predictions/              # Предсказания на тестовых данных
│   │   └── config_backup.yaml        # Копия конфига эксперимента
│   └── exp_002_regression/           # Эксперимент 2
│
├── 📁 app/                            # Веб-приложение (прототип)
│   ├── static/                       # CSS, JS, изображения
│   ├── templates/                    # HTML шаблоны
│   ├── app.py                        # Flask/Streamlit приложение
│   └── requirements_app.txt          # Зависимости для приложения
│
├── 📁 results/                        # Финальные результаты проекта
│   ├── detected_images/              # Изображения с детекцией
│   │   ├── raw_processed/            # После обработки пользовательских
│   │   └── train_processed/          # После обработки тренировочных
│   ├── reports/                      # Отчеты в PDF/Excel
│   └── emissions_data/               # Расчеты выбросов
│
├── 📁 tests/                          # Тесты
│   ├── test_data_preprocessing.py
│   ├── test_detection.py
│   └── test_regression.py
│
├── 📁 docs/                           # Документация
│   ├── project_description.md        # Описание проекта
│   ├── api_documentation.md          # Документация API
│   └── user_manual.md                # Руководство пользователя
│
├── 📁 flaring-gas/                    # [ВАША ТЕКУЩАЯ СТРУКТУРА - для совместимости]
│   ├── row/                          # Сырые изображения от пользователей
│   ├── train/                        # Данные для обучения
│   ├── detected/                     # Обработанные с разметкой
│   └── valid/                        # Данные для валидации
│
├── main.py                           # Основной скрипт (точка входа)
├── main.ipynb                        # Основной ноутбук
├── requirements.txt                  # Зависимости проекта
├── requirements_dev.txt              # Зависимости для разработки
├── pyproject.toml                    # Конфигурация проекта (альтернатива setup.py)
├── .env.example                      # Пример переменных окружения
├── .gitignore                       # Игнорируемые файлы для Git
├── README.md                        # Описание проекта
└── venv/                            # Виртуальное окружение


Архитектура проекта:
┌─────────────────────────────────────────────────────────────┐
│                      ВНЕШНИЕ ИСТОЧНИКИ                       │
│  ┌──────────┐  ┌──────────┐  ┌──────────────┐             │
│  │ Roboflow │  │   NASA   │  │ Пользователи  │             │
│  │   API    │  │   ESA    │  │   (файлы)     │             │
│  └────┬─────┘  └────┬─────┘  └──────┬───────┘             │
└───────┼─────────────┼────────────────┼──────────────────────┘
        │             │                │
        ▼             ▼                ▼
┌─────────────────────────────────────────────────────────────┐
│                    DATA LAYER (Слой данных)                  │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                    data/                              │   │
│  │  raw/ → external/ → interim/ → processed/ → models/  │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                  PROCESSING LAYER (Обработка)                │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                    src/                               │   │
│  │  ├── data_preprocessing/    # Подготовка данных      │   │
│  │  ├── detection/             # Обнаружение факелов    │   │
│  │  ├── regression/            # Оценка выбросов        │   │
│  │  └── visualization/         # Визуализация          │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                   OUTPUT LAYER (Результаты)                  │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              results/  AND  experiments/             │   │
│  │  ├── detected_images/     # Изображения с боксами   │   │
│  │  ├── reports/             # Отчеты PDF               │   │
│  │  └── emissions_data/      # Данные по выбросам      │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                 INTERFACE LAYER (Интерфейсы)                 │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  notebooks/  │  app/  │  main.py  │  tests/  │ docs/ │   │
│  │  (анализ)    │(веб UI)│(CLI)      │(тесты)   │(доки) │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
